<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot a default layout of gated populations of a set of FCS files (e.g. from one experiment) — plot_gates • fcexpr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a default layout of gated populations of a set of FCS files (e.g. from one experiment) — plot_gates"><meta property="og:description" content="Getting an overview of the results of a flow cytometry experiment can be a generic task if gating and analysis strategy is fixed.
Here, ggcyto is used to create an arrangement of pseudocolor plots. A number of default settings has been selected which may garuantee
good looking plots for most cases. Upon problems, the function may be improved to handle edge cases. Currently, customization is limited to a few rather technical
aspects of the plots. This may be subject to expansion but generally the range of customization is too large to fit it into a generic function with a finite number of arguments.
Hence, for very specific and detailed requriements manual plotting and fiddling is unavoidable. For that, the code of this function may serve as
a template."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fcexpr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9950</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/create_and_maintain_a_meta_data_table.html">create_and_maintain_a_meta_data_table</a>
    </li>
    <li>
      <a href="../articles/import_data_from_fj_workspaces.html">import data from FlowJo workspaces</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a default layout of gated populations of a set of FCS files (e.g. from one experiment)</h1>
    
    <div class="hidden name"><code>plot_gates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Getting an overview of the results of a flow cytometry experiment can be a generic task if gating and analysis strategy is fixed.
Here, ggcyto is used to create an arrangement of pseudocolor plots. A number of default settings has been selected which may garuantee
good looking plots for most cases. Upon problems, the function may be improved to handle edge cases. Currently, customization is limited to a few rather technical
aspects of the plots. This may be subject to expansion but generally the range of customization is too large to fit it into a generic function with a finite number of arguments.
Hence, for very specific and detailed requriements manual plotting and fiddling is unavoidable. For that, the code of this function may serve as
a template.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_gates</span><span class="op">(</span>
  <span class="va">gs</span>,
  <span class="va">gates_df</span>,
  facetting <span class="op">=</span> <span class="cn">NULL</span>,
  plot_gates <span class="op">=</span> <span class="cn">T</span>,
  plot_gate_names <span class="op">=</span> <span class="cn">T</span>,
  plot_gate_pct <span class="op">=</span> <span class="cn">T</span>,
  inverse_trans <span class="op">=</span> <span class="cn">F</span>,
  geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hex"</span>, <span class="st">"pointdensity"</span>, <span class="st">"scattermore"</span><span class="op">)</span>,
  gate_color <span class="op">=</span> <span class="st">"black"</span>,
  gate_stats_color <span class="op">=</span> <span class="st">"black"</span>,
  plot_contours <span class="op">=</span> <span class="cn">F</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gs</dt>
<dd><p>a gatingset, e.g. made with fcexpr::wsp_get_gs</p></dd>
<dt>gates_df</dt>
<dd><p>a data frame with informaion of how to plot gates, made with fcexpr::gs_get_gates</p></dd>
<dt>facetting</dt>
<dd><p>which facetting (ggplot2) to apply, facet_wrap or facet_grid with respective arguments, check flowCore::pData(gs) for valid columns;
facet_null will completely remove facets; by default facetting is done across fcs each individual fcs file</p></dd>
<dt>plot_gates</dt>
<dd><p>logical whether to plot gates</p></dd>
<dt>plot_gate_names</dt>
<dd><p>logical whether to plot gate names</p></dd>
<dt>plot_gate_pct</dt>
<dd><p>logical whether to plot gate percentages (fraction of parent)</p></dd>
<dt>inverse_trans</dt>
<dd><p>logical wheter to inverse transform axes numbers; if TRUE this will make axes look like in flowjo</p></dd>
<dt>geom</dt>
<dd><p>how to plot data; recommendation is hex; hex = geom_hex taking the binwidths column of gates_df into account, pointdensity = ggpointdensity::geom_pointdensity (see ...
and optionally provide max_nrow_to_plot (passed to ggcyto::ggcyto) to limit the number of dots per plot, defaults to 2000; be careful may increase time for plotting a lot),
scattermore = scattermore::geom_scattermore which is a high performance dot plot version for quickly plotting millions of points (only black-white currently)</p></dd>
<dt>gate_color</dt>
<dd><p>line color of gates</p></dd>
<dt>gate_stats_color</dt>
<dd><p>font color of gate statistics</p></dd>
<dt>plot_contours</dt>
<dd><p>logical whether to plot contour lines on top with ggplot2::geom_density_2d</p></dd>
<dt>...</dt>
<dd><p>arguments passed to ggplot2::theme; set a global default theme with ggplot2:theme_set() and ggplot2::theme_update();
arguments to ggpointdensity::geom_pointdensity like adjust or size: pointdensity__adjust (defaults to 5), pointdensity__size (defaults to 0.3),
arguments to scattermore::geom_scattermore like scattermore__pointsize = 0.1, arguments to contours like contour__alpha (defaults to 0.5)
or contour__color (defaults to grey65 if geom != scattermore or to tomato2 if geom == scattermore)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a list of ggplot2 objects, one for every gating level; each list index contains respective plots for every fcs file</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## read gatingset</span></span>
<span class="r-in"><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu">fcexpr</span><span class="fu">::</span><span class="fu"><a href="wsp_get_gs.html">wsp_get_gs</a></span><span class="op">(</span>wsp <span class="op">=</span> <span class="va">ws</span>, groups <span class="op">=</span> <span class="st">"Group1"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## write meta data to pData of gs; sd is sampledescripion</span></span>
<span class="r-in"><span class="va">p.df</span> <span class="op">&lt;-</span></span>
<span class="r-in"><span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">gs</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span class="r-in"><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"FileName"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span class="r-in"><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span class="r-in"><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"FileName"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p.df</span><span class="op">$</span><span class="va">FileName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">p.df</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">flowCore</span><span class="fu">::</span><span class="fu">pData</span><span class="op">(</span><span class="va">gs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">p.df</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## get the gates_df, optionally select relevant gates, and modify</span></span>
<span class="r-in"><span class="va">gates</span> <span class="op">&lt;-</span> <span class="fu">fcexpr</span><span class="fu">::</span><span class="fu"><a href="gs_get_gates.html">gs_get_gates</a></span><span class="op">(</span><span class="va">gs</span>, n_bins <span class="op">=</span> <span class="fl">100</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gates</span> <span class="op">&lt;-</span> <span class="va">gates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">gates</span><span class="op">$</span><span class="va">Population</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD8+"</span>, <span class="st">"CD8-"</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span class="r-in"><span class="va">gates</span><span class="op">$</span><span class="va">facet_strip</span> <span class="op">&lt;-</span> <span class="cn">T</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## selected gates; to order facetted plot the inline factor level</span></span>
<span class="r-in"><span class="co">## ordering is required as flowCore::pData(gs) cannot contain factors</span></span>
<span class="r-in"><span class="co">## axis.text = element_blank() is part of ... and will omit axis numbers (passed to ggplot2::theme)</span></span>
<span class="r-in"><span class="va">plotlist</span> <span class="op">&lt;-</span></span>
<span class="r-in"><span class="fu">fcexpr</span><span class="fu">::</span><span class="fu">plot_gates</span><span class="op">(</span>gs <span class="op">=</span> <span class="va">gs</span>,</span>
<span class="r-in">gates_df <span class="op">=</span> <span class="va">gates</span>,</span>
<span class="r-in">facetting <span class="op">=</span> <span class="fu">facet_grid</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">diluton_factor</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">p.df</span><span class="op">$</span><span class="va">diluton_factor</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="va">CD8_biotin_batch</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">axis.text <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## paste plots together with patchwork and save</span></span>
<span class="r-in"><span class="co">## patchwork is superior to cowplot as is will completely ignore ommitted facet_strips</span></span>
<span class="r-in"><span class="fu">ggsave</span><span class="op">(</span><span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">plotlist</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"facsplots.png"</span><span class="op">)</span>, device <span class="op">=</span> <span class="st">"png"</span>, path <span class="op">=</span> <span class="va">im_path</span>, dpi <span class="op">=</span> <span class="st">"retina"</span>, width <span class="op">=</span> <span class="fl">18</span>, height <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christopher Mark Skopnik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

